#!/usr/bin/env python

from IPython import embed
from graph_tool.all import load_graph, graph_draw
from graph_tool.draw import *
import sys
import os
import shutil

if len(sys.argv) < 1 :
  print '''usage : graphml filename
  graphml filename -n max_length_of_name
  graphml filename -x 
  '''

G = load_graph(sys.argv[1], 'xml')
names = G.vertex_properties['name']
labels = G.vertex_properties['label']

if len(sys.argv) < 3 : 
  interactive_window(G, vertex_text=labels, geometry=(201,200))
elif sys.argv[2] == '-n' :
  newNames = G.new_vertex_property("string")
  loc = sys.argv[3]
  for v in G.vertices() :
    if len(names[v]) > 3 :
      newNames[v] = names[v][-loc:]
  else :
    newNames[v] = names[v]
  interactive_window(G, vertex_text=newNames, geometry=(201,200))
elif sys.argv[2] == '-x' :
  interactive_window(G, geometry=(201,200))
elif sys.argv[2] == "-f" :
  filePath = sys.argv[3]+".png"
  if os.path.exists(filePath) :
    os.remove(filePath)
    graph_draw(G, vertex_text=names, output=filePath)
  else :
    graph_draw(G, vertex_text=names, output=filePath)

